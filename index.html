<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaktive KI-Toolbox | Workshop BW Juli 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Libraries for PDF and CSV/XLSX export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .details-content {
            transition: max-height 0.5s ease-in-out, opacity 0.5s ease-in-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        .details-content.open {
            max-height: 1500px; /* Adjust as needed */
            opacity: 1;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-bold text-slate-900 flex items-center justify-center">
                <img src="https://i.imgur.com/PKXYVWW.png" alt="Workshop Logo" class="h-12 mr-4">
                <span>Interaktive KI-Toolbox</span>
            </h1>
            <p class="text-slate-600 mt-2">Ein praxisnaher Überblick für den KI-Workshop | Bildungswelten (BW) - Juli 2025</p>
        </header>

        <!-- Theory Section -->
        <div id="theorySection" class="mb-12">
            <h2 class="text-2xl font-bold text-slate-800 border-b-2 border-indigo-500 pb-2 mb-6">Theoretische Grundlagen</h2>
            <div id="theoryCardsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Theory cards will be dynamically inserted here -->
            </div>
        </div>

        <!-- Practical Tools Section -->
        <div id="toolsSection">
            <h2 class="text-2xl font-bold text-slate-800 border-b-2 border-indigo-500 pb-2 mb-6">Praktische KI-Tools</h2>
            <!-- Controls Section -->
            <div class="bg-white p-4 rounded-xl shadow-lg mb-8 sticky top-4 z-10">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <input type="text" id="searchInput" onkeyup="filterAndRender()" placeholder="Tool suchen..." class="md:col-span-2 w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                    
                    <select id="categoryFilter" onchange="filterAndRender()" class="w-full p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition">
                        <option value="">Alle Kategorien</option>
                        <option>Abteilungsübergreifend</option>
                        <option>Automatisierung mittels KI</option>
                        <option>Effizient arbeiten</option>
                        <option>Bessere Entscheidungen</option>
                        <option>Vertrieb & Marketing</option>
                        <option>Interne Supply Chain</option>
                        <option>Einkauf & Beschaffung</option>
                        <option>Produktion</option>
                    </select>

                    <div class="grid grid-cols-2 gap-4">
                        <button onclick="exportToPDF()" class="w-full bg-indigo-600 text-white p-3 rounded-lg font-semibold hover:bg-indigo-700 transition-all shadow-sm hover:shadow-md flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
                            PDF
                        </button>
                        <button onclick="exportToXLSX()" class="w-full bg-emerald-600 text-white p-3 rounded-lg font-semibold hover:bg-emerald-700 transition-all shadow-sm hover:shadow-md flex items-center justify-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="M12 18v-6"></path><path d="m9 15 3-3 3 3"></path></svg>
                            Excel
                        </button>
                    </div>
                </div>
            </div>

            <!-- Cards Container -->
            <div id="cardsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Tool cards will be dynamically inserted here -->
            </div>
            <div id="noResults" class="hidden text-center p-16 text-slate-500 bg-white rounded-lg shadow-md">
                <p class="text-xl">Keine Tools für die ausgewählten Filter gefunden.</p>
            </div>
        </div>
    </div>

<script>
    // --- DATA MODEL ---
    const theoryData = [
        { id: 'term-1', name: '1. Digitalisierung', purpose: 'Die Umwandlung von analogen Informationen oder Prozessen in eine digitale Form. Es ist die absolute Grundlage für alles Weitere.', category: 'Grundlagen & Konzepte', praxisbeispiele: '<p><strong>Anschauliches Beispiel:</strong> Eine Papierrechnung wird gescannt und als PDF-Datei gespeichert. Der Prozess (Rechnung prüfen, bezahlen) ist vielleicht noch manuell, aber das Dokument selbst ist jetzt digital und kann einfach per E-Mail versendet oder in einem digitalen Archiv gesucht werden.</p>' },
        { id: 'term-2', name: '2. Automatisierung', purpose: 'Die Nutzung von Technologie, um eine Aufgabe oder einen Prozess nach festen, vordefinierten Regeln ohne menschliches Eingreifen auszuführen.', category: 'Grundlagen & Konzepte', praxisbeispiele: '<p><strong>Anschauliches Beispiel:</strong> Sie erstellen eine Regel in Ihrem E-Mail-Programm: "Wenn eine E-Mail vom Absender \'chef@firma.de\' kommt, markiere sie automatisch als \'Wichtig\'". Das System folgt stur dieser einen Regel (IF-THEN-Logik) und nimmt Ihnen einen kleinen, wiederkehrenden Arbeitsschritt ab.</p>' },
        { id: 'term-3', name: '3. KI-unterstützte Automatisierung', purpose: 'Eine intelligentere Form der Automatisierung, bei der KI-Modelle komplexe, unstrukturierte Aufgaben innerhalb eines automatisierten Workflows übernehmen.', category: 'Grundlagen & Konzepte', praxisbeispiele: '<p><strong>Anschauliches Beispiel:</strong> Eine E-Mail mit einer PDF-Rechnung kommt an. Die Automatisierung startet, aber anstatt nur Regeln zu folgen, analysiert eine KI das PDF, erkennt (egal bei welchem Rechnungs-Layout) den Rechnungsbetrag, das Fälligkeitsdatum und die IBAN und trägt diese Daten automatisch in die Buchhaltungssoftware ein. Die KI trifft hier eine kontextbezogene Entscheidung.</p>' },
        { id: 'term-4', name: '4. Agentische KI (Agentic AI)', purpose: 'Ein KI-System ("Agent"), das ein Ziel erhält und dann selbstständig eine Kette von Aktionen plant und durchführt, um dieses Ziel zu erreichen.', category: 'Grundlagen & Konzepte', praxisbeispiele: '<p><strong>Anschauliches Beispiel:</strong> Sie geben einem KI-Reise-Agenten das Ziel: "Buche mir für nächste Woche einen möglichst günstigen 3-Tage-Trip nach Berlin, inklusive Flug und Hotel mit guten Bewertungen." Der Agent sucht nun selbstständig nach Flügen auf Airline-Websites, vergleicht Hotelpreise auf verschiedenen Portalen, liest und bewertet Rezensionen, prüft die Lage der Hotels und präsentiert Ihnen am Ende eine fertige, optimierte Buchungsoption, ohne dass Sie jeden einzelnen Schritt vorgeben mussten.</p>' },
        { id: 'term-5', name: "5. 'USB' für KI - MCP von Anthropic", purpose: 'Eine Methode, um KI-Modellen eine "Verfassung" oder Grundregeln zu geben, die ihr Verhalten steuern, unabhängig vom spezifischen Modell.', category: 'Grundlagen & Konzepte', praxisbeispiele: '<p><strong>Anschauliches Beispiel:</strong> Stellen Sie sich einen USB-Stick vor, auf dem die "Verfassung" Ihres Unternehmens für KI-Kundenservice gespeichert ist: "Sei immer höflich, mache niemals finanzielle Versprechungen, leite bei Beschwerden an einen Menschen weiter." Diesen "MCP-Stick" können Sie nun an verschiedene KI-Modelle (einen Chatbot, eine E-Mail-KI, einen Sprachassistenten) "anschließen", und alle folgen denselben Kernprinzipien, ohne dass jedes Modell einzeln dafür trainiert werden muss.</p>' }
    ];

    const aiToolsData = [
        { id: 'tool-1', name: 'ChatGPT / GPT-4', purpose: 'Textgenerierung, Automatisierung, Code-Erstellung', time: 80, cost: 40, area: 'Marketing, Kundenservice, Entwicklung, HR', category: 'Abteilungsübergreifend', praxisbeispiele: '<ul><li class="mb-1"><strong>Marketing:</strong> Erstellung von Blog-Artikeln, Social-Media-Posts und Werbetexten.</li><li class="mb-1"><strong>Kundenservice:</strong> Entwicklung von Chatbot-Skripten zur Beantwortung häufiger Fragen.</li><li><strong>HR:</strong> Formulierung von Stellenanzeigen und internen Mitteilungen.</li></ul>' },
        { id: 'tool-3', name: 'Copilot 365', purpose: 'KI-Integration in Office-Anwendungen', time: 70, cost: 35, area: 'Büroorganisation, Management', category: 'Abteilungsübergreifend', praxisbeispiele: '<ul><li class="mb-1"><strong>Word:</strong> Automatische Zusammenfassung langer Dokumente.</li><li class="mb-1"><strong>Excel:</strong> Erstellung von Formeln und Diagrammen durch einfache textuelle Anweisungen.</li><li><strong>Teams:</strong> Protokollierung von Meetings und Zuweisung von Aufgaben.</li></ul>' },
        { id: 'tool-14', name: 'Zapier', purpose: 'Verbindet Web-Apps und automatisiert Workflows ohne Code', time: 90, cost: 50, area: 'Marketing, Vertrieb, IT, Operations', category: 'Automatisierung mittels KI', praxisbeispiele: '<ul><li class="mb-1"><strong>Definition:</strong> Zapier ist eine Online-Automatisierungsplattform, die es Benutzern ermöglicht, verschiedene Webanwendungen miteinander zu verbinden. Die KI-Komponente hilft bei der Erstellung, Formatierung und Verarbeitung von Daten zwischen den Schritten.</li><li class="mb-1"><strong>Beispiel:</strong> Wenn ein neuer Lead in HubSpot erstellt wird, erstelle automatisch eine Zeile in Google Sheets und sende eine Slack-Benachrichtigung an das Vertriebsteam.</li></ul>' },
        { id: 'tool-15', name: 'Make.com', purpose: 'Visuelle Plattform zur Erstellung, Automatisierung und Optimierung von Workflows', time: 90, cost: 55, area: 'Marketing, Operations, IT, Produktmanagement', category: 'Automatisierung mittels KI', praxisbeispiele: '<ul><li class="mb-1"><strong>Definition:</strong> Make (früher Integromat) ist eine visuelle Automatisierungsplattform, die komplexe, mehrstufige Szenarien mit Verzweigungen und Logik ermöglicht.</li><li class="mb-1"><strong>Beispiel:</strong> Wenn eine E-Mail mit einem Anhang in einem bestimmten Gmail-Postfach ankommt, lade den Anhang in Google Drive hoch, erstelle eine Aufgabe in Asana und benachrichtige den Projektmanager.</li></ul><p class="mt-4 text-sm"><strong>Praxis-Tutorial:</strong> Dieses Tutorial-Video führt Sie Schritt für Schritt durch die Erstellung Ihres ersten Automatisierungs-Szenarios. Sie lernen, wie eine Google Formular-Antwort automatisch in eine Google Tabelle eingetragen und eine Benachrichtigung in Slack gesendet wird – ein perfektes Beispiel, um die Funktionsweise zu verstehen.</p><div class="mt-2 rounded-lg overflow-hidden aspect-video"><iframe class="w-full h-full" src="https://www.youtube.com/embed/5FTr2hPArnI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>' },
        { id: 'tool-16', name: 'n8n.io', purpose: 'Open-Source Workflow-Automatisierung (self-hosted oder Cloud)', time: 85, cost: 80, area: 'IT, Entwicklung, Daten-Teams', category: 'Automatisierung mittels KI', praxisbeispiele: '<ul><li class="mb-1"><strong>Definition:</strong> n8n ist eine erweiterbare Workflow-Automatisierungsplattform, die entweder in der Cloud oder auf eigenen Servern betrieben werden kann (Open-Source), was mehr Kontrolle und potenziell niedrigere Kosten ermöglicht.</li><li class="mb-1"><strong>Beispiel:</strong> Sammle täglich Daten aus verschiedenen APIs (z.B. Wetter, Aktienkurse), verarbeite sie und erstelle einen zusammenfassenden Bericht, der per E-Mail versendet wird.</li></ul>' },
        { id: 'tool-2', name: 'Midjourney', purpose: 'Erstellung von Bildern aus Textbeschreibungen', time: 75, cost: 60, area: 'Marketing, Design, Produktentwicklung', category: 'Effizient arbeiten', praxisbeispiele: '<ul><li class="mb-1"><strong>Design:</strong> Schnelles Prototyping von Logos, Webdesigns und Produktvisualisierungen.</li><li><strong>Marketing:</strong> Generierung einzigartiger Bilder für Werbekampagnen ohne teure Stockfotos.</li></ul>' },
        { id: 'tool-13', name: 'Gemini (Deep Research & Reasoning)', purpose: 'Komplexe Recherche, Datenanalyse und Erstellung von Entscheidungsgrundlagen', time: 80, cost: 50, area: 'Strategie, Marktanalyse, F&E, Rechtsabteilung', category: 'Bessere Entscheidungen', praxisbeispiele: '<ul><li class="mb-1"><strong>Marktanalyse:</strong> Umfassende Analyse von Markttrends, Wettbewerbslandschaften und Kundenfeedback aus tausenden von Quellen.</li><li class="mb-1"><strong>Forschung & Entwicklung:</strong> Durchsuchen von wissenschaftlichen Papieren und Patenten, um Innovationspotenziale zu identifizieren.</li><li><strong>Rechtsabteilung:</strong> Schnelle Analyse von Verträgen und juristischen Dokumenten zur Identifizierung von Risiken und relevanten Klauseln.</li></ul>' },
        { id: 'tool-4', name: 'Copilot 365 (Analyst & Researcher)', purpose: 'Tiefe Datenanalyse und Recherche in Unternehmensdaten', time: 65, cost: 45, area: 'Strategie, Controlling, Marktforschung', category: 'Bessere Entscheidungen', praxisbeispiele: '<ul><li class="mb-1"><strong>Analyst:</strong> Identifizierung von Verkaufstrends durch Analyse von internen Finanzdaten in Excel.</li><li class="mb-1"><strong>Researcher:</strong> Zusammenfassung von Wettbewerbsinformationen aus verschiedenen internen Dokumenten.</li><li><strong>Strategie:</strong> Erstellung von SWOT-Analysen basierend auf Quartalsberichten.</li></ul>' },
        { id: 'tool-6', name: 'ThoughtSpot', purpose: 'Such- & KI-gesteuerte Analyseplattform', time: 70, cost: 65, area: 'Business Intelligence, Datenanalyse für alle', category: 'Bessere Entscheidungen', praxisbeispiele: '<ul><li class="mb-1"><strong>Marketing:</strong> Ein einfacher Such-Prompt wie "wöchentliche Verkäufe nach Kampagne letzte 6 Monate" erzeugt sofort ein Diagramm.</li><li><strong>HR:</strong> Analyse der Mitarbeiterfluktuation nach Abteilung durch simple Fragen.</li></ul>' },
        { id: 'tool-8', name: 'HubSpot AI', purpose: 'Automatisierung von Marketing und Lead-Scoring', time: 60, cost: 40, area: 'Vertrieb, Marketing', category: 'Vertrieb & Marketing', praxisbeispiele: '<ul><li class="mb-1"><strong>Lead-Scoring:</strong> Automatische Bewertung von neuen Kontakten basierend auf deren Interaktionen.</li><li><strong>Content-Erstellung:</strong> Generierung von E-Mail-Betreffzeilen und Landing-Page-Texten.</li></ul>' },
        { id: 'tool-7', name: 'SAP IBP', purpose: 'Integrierte Geschäftsplanung für Prognosen', time: 75, cost: 70, area: 'Supply Chain, Logistik', category: 'Interne Supply Chain', praxisbeispiele: '<ul><li class="mb-1"><strong>Bedarfsplanung:</strong> KI-gestützte Prognose der Nachfrage für die nächsten 12 Monate.</li><li><strong>Bestandsoptimierung:</strong> Berechnung optimaler Lagerbestände zur Vermeidung von Engpässen und Überbeständen.</li></ul>' },
        { id: 'tool-10', name: 'Scoutbee', purpose: 'KI-basierte Lieferantensuche und -analyse', time: 85, cost: 75, area: 'Einkauf, Beschaffung', category: 'Einkauf & Beschaffung', praxisbeispiele: '<ul><li class="mb-1"><strong>Lieferantensuche:</strong> Identifizierung neuer, qualifizierter Lieferanten weltweit basierend auf spezifischen Kriterien.</li><li><strong>Risikomanagement:</strong> Überwachung der finanziellen Stabilität und Nachhaltigkeit von Lieferanten.</li></ul>' },
        { id: 'tool-11', name: 'Cognex ViDi Suite', purpose: 'Deep-Learning-basierte Bildanalyse zur Qualitätskontrolle', time: 40, cost: 65, area: 'Fertigung, Qualitätssicherung', category: 'Produktion', praxisbeispiele: '<ul><li class="mb-1"><strong>Fehlererkennung:</strong> Automatische Identifizierung von Kratzern, Dellen oder Montagefehlern in Echtzeit.</li><li><strong>Klassifizierung:</strong> Sortierung von Produkten nach Qualitätsmerkmalen.</li></ul>' },
        { id: 'tool-12', name: 'Siemens Mindsphere - Predictive Maintenance', purpose: 'Vorausschauende Wartung von Maschinen durch Sensordatenanalyse', time: 45, cost: 60, area: 'Instandhaltung, Fertigungsplanung', category: 'Produktion', praxisbeispiele: '<ul><li class="mb-1"><strong>Anlagenüberwachung:</strong> Vorhersage von Maschinenausfällen, bevor sie auftreten.</li><li><strong>Wartungsplanung:</strong> Optimierung von Wartungsintervallen zur Reduzierung von Stillstandszeiten.</li></ul>' }
    ];

    function toggleDetails(toolId) {
        const details = document.getElementById(`details-${toolId}`);
        const button = document.getElementById(`button-${toolId}`);
        details.classList.toggle('open');
        if (details.classList.contains('open')) {
            button.innerHTML = 'Details ausblenden <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-1"><polyline points="18 15 12 9 6 15"></polyline></svg>';
        } else {
            button.innerHTML = 'Beispiel anzeigen <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-1"><polyline points="6 9 12 15 18 9"></polyline></svg>';
        }
    }

    function renderCards(data, containerId) {
        const cardsContainer = document.getElementById(containerId);
        cardsContainer.innerHTML = "";

        data.forEach(tool => {
            const isConcept = tool.category === 'Grundlagen & Konzepte';
            const card = document.createElement('div');
            card.className = 'bg-white rounded-xl shadow-md hover:shadow-xl transition-shadow duration-300 flex flex-col h-full';
            card.innerHTML = `
                <div class="p-6 flex-grow">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="text-xl font-bold text-slate-900">${tool.name}</h3>
                        ${!isConcept ? `<span class="px-2 py-1 bg-indigo-100 text-indigo-800 text-xs font-semibold rounded-full whitespace-nowrap">${tool.category}</span>` : ''}
                    </div>
                    <p class="text-slate-600 mb-4 text-sm">${tool.purpose}</p>
                    
                    <div class="space-y-3 text-sm mb-4 ${isConcept ? 'hidden' : ''}">
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-slate-700">Zeitersparnis</span>
                            <div class="flex items-center gap-2">
                                <div class="w-24 bg-slate-200 rounded-full h-2"><div class="h-2 rounded-full bg-teal-500" style="width: ${tool.time}%"></div></div>
                                <span class="w-12 text-right font-semibold">${tool.time}%</span>
                            </div>
                        </div>
                        <div class="flex items-center justify-between">
                            <span class="font-medium text-slate-700">Kosteneinsparung</span>
                            <div class="flex items-center gap-2">
                                <div class="w-24 bg-slate-200 rounded-full h-2"><div class="h-2 rounded-full bg-amber-500" style="width: ${tool.cost}%"></div></div>
                                <span class="w-12 text-right font-semibold">${tool.cost}%</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="border-t border-slate-200 px-6 py-4 mt-auto">
                    <div id="details-${tool.id}" class="details-content text-sm text-slate-700 prose prose-sm max-w-none">
                        <h4 class="font-semibold mb-2">${isConcept ? 'Anschauliches Beispiel:' : 'Details & Praxisbeispiele:'}</h4>
                        ${tool.praxisbeispiele}
                    </div>
                </div>
                <div class="bg-slate-50 rounded-b-xl px-6 py-3 border-t border-slate-200">
                     <button id="button-${tool.id}" onclick="toggleDetails('${tool.id}')" class="text-indigo-600 font-semibold text-sm hover:text-indigo-800 transition flex items-center w-full justify-center">
                        ${isConcept ? 'Beispiel anzeigen' : 'Praxisbeispiele anzeigen'}
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="ml-1"><polyline points="6 9 12 15 18 9"></polyline></svg>
                    </button>
                </div>
            `;
            cardsContainer.appendChild(card);
        });
    }

    function getFilteredData() {
        const searchInput = document.getElementById('searchInput').value.toLowerCase();
        const categoryFilter = document.getElementById('categoryFilter').value;

        return aiToolsData.filter(tool => {
            const nameMatch = tool.name.toLowerCase().includes(searchInput) || tool.purpose.toLowerCase().includes(searchInput);
            const categoryMatch = categoryFilter ? tool.category === categoryFilter : true;
            return nameMatch && categoryMatch;
        });
    }
    
    function filterAndRender() {
        const filteredData = getFilteredData();
        const toolCardsContainer = document.getElementById('cardsContainer');
        const noResultsDiv = document.getElementById('noResults');
        
        toolCardsContainer.innerHTML = ''; // Clear previous results

        if (filteredData.length === 0) {
            noResultsDiv.classList.remove('hidden');
            toolCardsContainer.classList.add('hidden');
        } else {
            noResultsDiv.classList.add('hidden');
            toolCardsContainer.classList.remove('hidden');
            renderCards(filteredData, 'cardsContainer');
        }
    }

    // --- EXPORT FUNCTIONS ---
    function exportToPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({ orientation: 'landscape' });
        const data = getFilteredData();

        doc.setFont('Inter', 'normal');
        doc.text("KI-Toolbox | Workshop BW Juli 2025", 14, 16);
        
        const head = [['Name', 'Nutzen', 'Zeitersparnis (%)', 'Kosteneinsparung (%)', 'Einsatzbereich', 'Kategorie']];
        const body = data.map(tool => [
            tool.name,
            tool.purpose,
            `${tool.time}%`,
            `${tool.cost}%`,
            tool.area,
            tool.category
        ]);

        doc.autoTable({
            head: head,
            body: body,
            startY: 22,
            theme: 'grid',
            headStyles: { fillColor: [30, 41, 59] }, // slate-800
            styles: { font: 'Inter', cellPadding: 2.5, fontSize: 8 },
        });
        
        doc.save('KI-Toolbox-Export.pdf');
    }

    function exportToXLSX() {
        const data = getFilteredData();
        const worksheetData = data.map(tool => ({
            'Name des Tools': tool.name,
            'Kernzweck / Nutzen': tool.purpose,
            'Zeitersparnis (%)': tool.time,
            'Kosteneinsparung (%)': tool.cost,
            'Einsatzbereich': tool.area,
            'Kategorie': tool.category
        }));
        
        const ws = XLSX.utils.json_to_sheet(worksheetData);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "KI-Tools");
        XLSX.writeFile(wb, "KI-Toolbox-Export.xlsx");
    }

    // --- INITIALIZATION ---
    window.onload = () => {
        // Render theory cards separately and permanently
        renderCards(theoryData, 'theoryCardsContainer');
        // Render and filter tool cards
        filterAndRender();
    };
</script>

</body>
</html>
